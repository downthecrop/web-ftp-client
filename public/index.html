<!DOCTYPE html>
<html>
<head>
	<script>window.$ = window.jQuery = require('jquery');</script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
    <link rel="stylesheet" type="text/css" href="stylesheets/lib/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="stylesheets/dist/general.css">
    <link rel="shortcut icon" href="images/logo.png" type="image/png">
    <script type="text/javascript" src="scripts/lib/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="scripts/lib/jquery-ui.min.js"></script>
    <script type="text/javascript" src="scripts/lib/jquery.serializejson.min.js"></script>
    <script type="text/javascript" src="scripts/lib/jquery.tablesorter.min.js"></script>
    <script type="text/javascript" src="scripts/lib/bootstrap.min.js"></script>
    <script type="text/javascript" src="scripts/lib/bootstrap-select.min.js"></script>
    <script type="text/javascript" src="scripts/lib/bootstrap-notify.min.js"></script>
    <script type="text/javascript" src="scripts/dist/global.js"></script>
    <script type="text/javascript" src="scripts/dist/storage.js"></script>
    <script type="text/javascript" src="scripts/dist/lang.js"></script>
    <script type="text/javascript" src="scripts/dist/lang.values.js"></script>
    <script type="text/javascript" src="scripts/dist/socket.js"></script>
    <script type="text/javascript" src="scripts/dist/tpl.js"></script>
    <script type="text/javascript" src="scripts/dist/form.js"></script>
    <script type="text/javascript" src="scripts/dist/splitbox.js"></script>
    <title>Web FTP Client</title>
    <script type="application/javascript">
      gl.loadTheme(gl.storage.get('theme') || 'light')
    </script>
</head>
<body>
  <script>
  if (window.process && window.process !== undefined) { 
    document.body.innerHTML += "<div class='loader'></div>"
    document.body.innerHTML += "<div id='wrapper'></div>"
  }
 </script>
</body>
      <script>
         const {ipcRenderer} = require('electron')

           let systemStatus = null
 const $tpl = $('.template-menu-top')
  // interval to check for new version
  const getSystemStatus = function () {
    gl.socket.send('getSystemStatus', null, function (data) {
      if (data.latestVersion) {
        systemStatus = data
        $tpl.find('.version').text('v' + data.currentVersion)
      }
    })
  }
  
  getSystemStatus()

    function displayAbout() {
    const $body = $('<div>')
    $body.append(gl.t('about.modal'))
    $body.append($('<h3>').text(gl.t('about.tools')))
    $body.append(
      $('<ul>')
        .append('<li><a href="http://getbootstrap.com" target="_blank" rel="nofollow">Bootstrap (Frontend Framework)</a>')
        .append('<li><a href="http://bootswatch.com" target="_blank" rel="nofollow">Bootswatch Themes</a>')
        .append('<li><a href="https://nodejs.org" target="_blank" rel="nofollow">NodeJS (Backend)</a>')
        .append('<li><a href="http://expressjs.com" target="_blank" rel="nofollow">ExpressJS (Http Server)</a>')
        .append('<li><a href="https://github.com/mscdex/node-ftp" target="_blank" rel="nofollow">Node FTP Client</a>')
        .append('<li><a href="https://github.com/mscdex/ssh2" target="_blank" rel="nofollow">Node SSH Client</a>')
        .append('<li><a href="https://github.com/typicode/lowdb" target="_blank" rel="nofollow">Lowdb Database</a>')
        .append('<li><a href="https://github.com/websockets/ws" target="_blank" rel="nofollow">Node Websocket</a>')
    )
    $body.append($('<h3>').text('Changelog'))
    $body.append($('<div class="changelog">').html(systemStatus.changelog))
    gl.modal(gl.t('about'), $body, null, function () {
    })
  }

         // Synchronous message emmiter and handler
         console.log(ipcRenderer.sendSync('synchronous-message', 'sync ping')) 

         // Async message handler
         ipcRenderer.on('asynchronous-reply', (event, arg) => {
            if (arg=="About"){
				displayAbout();
			}
         })

         // Async message sender
         ipcRenderer.send('asynchronous-message', 'async ping')
      </script>
</html>